alpha = 1,
color = "black",
fontface = "bold",
nudge_x = 220) +
labs(title = "Cumulative returns of top ASISA funds",
subtitle = "Base Return: Benchmark",
y = "Cumulative Return",
x = "Date"))
View(funds)
library(ggrepel)
diffs <- data_subset1 %>%
group_by(Fund) %>%
filter(date == last(date)) %>%
ungroup()
bench_diff <- diffs %>%
dplyr::filter(Fund == "Benchmark") %>%
pull(Cum_Ret)
diffs <- diffs %>%
dplyr::filter(!Fund == "Benchmark") %>%
mutate(final_diff = Cum_Ret / bench_diff * 100 - 100) %>%
filter(!Fund == "Benchmark")
funds <- data_subset1 %>%
filter(!Fund == "Benchmark")
bench <- data_subset2 %>%
filter(Fund == "Benchmark")
fmxdat::finplot(ggplot() +
geom_line(data = bench,
aes(x = date,
y = Cum_Ret),
color = "black",
size = 1.2) +
geom_line(data = funds %>% dplyr::filter(!Fund == "AI_Fund"),
alpha = 0.7,
size = 0.8,
aes(x = date,
y = Cum_Ret,
color = Fund)) +
geom_line(data = funds %>% dplyr::filter(Fund == "AI_Fund"),
alpha = 0.7,
size = 1.2,
color = "red",
aes(x = date,
y = Cum_Ret,
color = Fund)) +
geom_label_repel(data = diffs,
aes(x = date,
y = Cum_Ret,
label = paste0(round(final_diff, 1), "%")),
size = ggpts(10),
alpha = 1,
color = "black",
fontface = "bold",
nudge_x = 220) +
labs(title = "Cumulative returns of top ASISA funds",
subtitle = "Base Return: Benchmark",
y = "Cumulative Return",
x = "Date"))
fee_rate <- 300 / 10000
# Annual rate compounded monthly
monthly_fee_rate <- (1 + fee_rate) ^ (1/12) - 1
# Apply monthly fee rate cumulatively using compound interest
asisa_fee1 <- data_subset1 %>%
arrange(date) %>%
dplyr::filter(Fund %in% best_asisa) %>%
group_by(Fund) %>%
mutate(Fee = Returns - monthly_fee_rate) %>%
mutate(Fee_Cum = cumprod(1 + Fee))
diffs <- asisa_fee1 %>%
group_by(Fund) %>%
filter(date == last(date)) %>%
ungroup()
diffs <- diffs %>%
dplyr::filter(!Fund == "Benchmark") %>%
mutate(final_diff = Fee_Cum / bench_diff * 100 - 100) %>%
filter(!Fund == "Benchmark")
funds <- asisa_fee1 %>%
filter(!Fund == "Benchmark")
fmxdat::finplot(ggplot() +
geom_line(data = bench,
aes(x = date,
y = Cum_Ret),
color = "black",
size = 1.2) +
geom_line(data = funds %>% dplyr::filter(!Fund == "AI_Fund"),
alpha = 0.7,
size = 0.8,
aes(x = date,
y = Fee_Cum,
color = Fund)) +
geom_line(data = funds %>% dplyr::filter(Fund == "AI_Fund"),
alpha = 0.7,
size = 1.2,
color = "red",
aes(x = date,
y = Cum_Ret,
color = Fund)) +
geom_label_repel(data = diffs,
aes(x = date,
y = Fee_Cum,
label = paste0(round(final_diff, 1), "%")),
size = ggpts(10),
alpha = 1,
color = "black",
fontface = "bold",
nudge_x = 220) +
labs(title = "Cumulative returns of top ASISA funds",
subtitle = "Base Return: Benchmark",
y = "Cumulative Return",
x = "Date"))
library(ggrepel)
diffs1 <- data_subset1 %>%
group_by(Fund) %>%
filter(date == last(date)) %>%
ungroup()
bench_diff <- diffs %>%
dplyr::filter(Fund == "Benchmark") %>%
pull(Cum_Ret)
diffs1 <- diffs %>%
dplyr::filter(!Fund == "Benchmark") %>%
mutate(final_diff = Cum_Ret / bench_diff * 100 - 100) %>%
filter(!Fund == "Benchmark")
library(ggrepel)
diffs1 <- data_subset1 %>%
group_by(Fund) %>%
filter(date == last(date)) %>%
ungroup()
bench_diff <- diffs %>%
dplyr::filter(Fund == "Benchmark") %>%
pull(Cum_Ret)
diffs1 <- diffs1 %>%
dplyr::filter(!Fund == "Benchmark") %>%
mutate(final_diff = Cum_Ret / bench_diff * 100 - 100) %>%
filter(!Fund == "Benchmark")
library(ggrepel)
diffs1 <- data_subset1 %>%
group_by(Fund) %>%
filter(date == last(date)) %>%
ungroup()
bench_diff <- diffs1 %>%
dplyr::filter(Fund == "Benchmark") %>%
pull(Cum_Ret)
diffs1 <- diffs1 %>%
dplyr::filter(!Fund == "Benchmark") %>%
mutate(final_diff = Cum_Ret / bench_diff * 100 - 100) %>%
filter(!Fund == "Benchmark")
funds <- data_subset1 %>%
filter(!Fund == "Benchmark")
bench <- data_subset1 %>%
filter(Fund == "Benchmark")
fmxdat::finplot(ggplot() +
geom_line(data = bench,
aes(x = date,
y = Cum_Ret),
color = "black",
size = 1.2) +
geom_line(data = funds1 %>% dplyr::filter(!Fund == "AI_Fund"),
alpha = 0.7,
size = 0.8,
aes(x = date,
y = Cum_Ret,
color = Fund)) +
geom_line(data = funds1 %>% dplyr::filter(Fund == "AI_Fund"),
alpha = 0.7,
size = 1.2,
color = "red",
aes(x = date,
y = Cum_Ret,
color = Fund)) +
geom_label_repel(data = diffs1,
aes(x = date,
y = Cum_Ret,
label = paste0(round(final_diff, 1), "%")),
size = ggpts(10),
alpha = 1,
color = "black",
fontface = "bold",
nudge_x = 220) +
labs(title = "Cumulative returns of top ASISA funds",
subtitle = "Base Return: Benchmark",
y = "Cumulative Return",
x = "Date"))
library(ggrepel)
diffs1 <- data_subset1 %>%
group_by(Fund) %>%
filter(date == last(date)) %>%
ungroup()
bench_diff <- diffs1 %>%
dplyr::filter(Fund == "Benchmark") %>%
pull(Cum_Ret)
diffs1 <- diffs1 %>%
dplyr::filter(!Fund == "Benchmark") %>%
mutate(final_diff = Cum_Ret / bench_diff * 100 - 100) %>%
filter(!Fund == "Benchmark")
funds1 <- data_subset1 %>%
filter(!Fund == "Benchmark")
bench <- data_subset1 %>%
filter(Fund == "Benchmark")
fmxdat::finplot(ggplot() +
geom_line(data = bench,
aes(x = date,
y = Cum_Ret),
color = "black",
size = 1.2) +
geom_line(data = funds1 %>% dplyr::filter(!Fund == "AI_Fund"),
alpha = 0.7,
size = 0.8,
aes(x = date,
y = Cum_Ret,
color = Fund)) +
geom_line(data = funds1 %>% dplyr::filter(Fund == "AI_Fund"),
alpha = 0.7,
size = 1.2,
color = "red",
aes(x = date,
y = Cum_Ret,
color = Fund)) +
geom_label_repel(data = diffs1,
aes(x = date,
y = Cum_Ret,
label = paste0(round(final_diff, 1), "%")),
size = ggpts(10),
alpha = 1,
color = "black",
fontface = "bold",
nudge_x = 220) +
labs(title = "Cumulative returns of top ASISA funds",
subtitle = "Base Return: Benchmark",
y = "Cumulative Return",
x = "Date"))
fmxdat::finplot(ggplot() +
geom_line(data = bench,
aes(x = date,
y = Cum_Ret),
color = "black",
size = 1.2) +
geom_line(data = funds1 %>% dplyr::filter(!Fund == "AI_Fund"),
alpha = 0.7,
size = 0.8,
aes(x = date,
y = Cum_Ret,
color = Fund)) +
geom_line(data = funds1 %>% dplyr::filter(Fund == "AI_Fund"),
alpha = 0.7,
size = 1.2,
color = "red",
aes(x = date,
y = Cum_Ret,
color = Fund)) +
geom_label_repel(data = diffs1,
aes(x = date,
y = Cum_Ret,
label = paste0(round(final_diff, 1), "%")),
size = ggpts(10),
alpha = 1,
color = "black",
fontface = "bold",
nudge_x = 220) +
labs(title = "Cumulative returns of top ASISA funds",
subtitle = "Base Return: Benchmark",
y = "Cumulative Return",
x = "Date"))
fmxdat::finplot(ggplot() +
geom_line(data = bench,
aes(x = date,
y = Cum_Ret),
color = "black",
size = 1.2) +
geom_line(data = funds1 %>% dplyr::filter(!Fund == "AI_Fund"),
alpha = 0.7,
size = 0.8,
aes(x = date,
y = Cum_Ret,
color = Fund)) +
geom_line(data = funds1 %>% dplyr::filter(Fund == "AI_Fund"),
alpha = 0.7,
size = 1.2,
color = "red",
aes(x = date,
y = Cum_Ret,
color = Fund)) +
geom_label_repel(data = diffs1,
aes(x = date,
y = Cum_Ret,
label = paste0(round(final_diff, 1), "%")),
size = ggpts(10),
alpha = 1,
color = "black",
fontface = "bold",
nudge_x = 220) +
labs(title = "Cumulative returns of top ASISA funds",
subtitle = "Benchmark: Capped SWIX",
y = "Cumulative Return",
x = "Date"))
fee_rate <- 300 / 10000
# Annual rate compounded monthly
monthly_fee_rate <- (1 + fee_rate) ^ (1/12) - 1
# Apply monthly fee rate cumulatively using compound interest
asisa_fee1 <- data_subset1 %>%
arrange(date) %>%
dplyr::filter(Fund %in% best_asisa) %>%
group_by(Fund) %>%
mutate(Fee = Returns - monthly_fee_rate) %>%
mutate(Fee_Cum = cumprod(1 + Fee))
diffs2 <- asisa_fee1 %>%
group_by(Fund) %>%
filter(date == last(date)) %>%
ungroup() %>%
dplyr::filter(!Fund == "Benchmark") %>%
mutate(final_diff = Fee_Cum / bench_diff * 100 - 100) %>%
filter(!Fund == "Benchmark")
funds2 <- asisa_fee1 %>%
filter(!Fund == "Benchmark")
fmxdat::finplot(ggplot() +
geom_line(data = bench,
aes(x = date,
y = Cum_Ret),
color = "black",
size = 1.2) +
geom_line(data = funds2 %>% dplyr::filter(!Fund == "AI_Fund"),
alpha = 0.7,
size = 0.8,
aes(x = date,
y = Fee_Cum,
color = Fund)) +
geom_line(data = funds1 %>% dplyr::filter(Fund == "AI_Fund"),
alpha = 0.7,
size = 1.2,
color = "red",
aes(x = date,
y = Cum_Ret,
color = Fund)) +
geom_label_repel(data = diffs2,
aes(x = date,
y = Fee_Cum,
label = paste0(round(final_diff, 1), "%")),
size = ggpts(10),
alpha = 1,
color = "black",
fontface = "bold",
nudge_x = 220) +
labs(title = "Cumulative returns of top ASISA funds",
subtitle = "Base Return: Benchmark",
y = "Cumulative Return",
x = "Date"))
fmxdat::finplot(ggplot() +
geom_line(data = bench,
aes(x = date,
y = Cum_Ret),
color = "black",
size = 1.2) +
geom_line(data = funds2 %>% dplyr::filter(!Fund == "AI_Fund"),
alpha = 0.7,
size = 0.8,
aes(x = date,
y = Fee_Cum,
color = Fund)) +
geom_line(data = funds1 %>% dplyr::filter(Fund == "AI_Fund"),
alpha = 0.7,
size = 1.2,
color = "red",
aes(x = date,
y = Cum_Ret,
color = Fund)) +
geom_label_repel(data = diffs2,
aes(x = date,
y = Fee_Cum,
label = paste0(round(final_diff, 1), "%")),
size = ggpts(10),
alpha = 1,
color = "black",
fontface = "bold",
nudge_x = 220) +
labs(title = "Cumulative returns of top ASISA funds",
subtitle = "Base Return: Benchmark",
y = "Cumulative Return",
x = "Date"))
fmxdat::finplot(ggplot() +
geom_line(data = data_subset1 %>% dplyr::filter(Fund %in% best_asisa),
aes(x = date,
y = Rolling_Ret,
color = Fund),
size = 0.7,
alpha = 0.5) +
geom_line(data = data_subset1 %>% dplyr::filter(Fund %in% c("Benchmark")),
aes(x = date,
y = Rolling_Ret),
color = "black",
linetype = "dashed",
size = 0.8) +
geom_line(data = data_subset1 %>% dplyr::filter(Fund %in% c("AI_Fund")),
aes(x = date,
y = Rolling_Ret),
size = 0.8,
color = "red") +
labs(title = "Rolling returns of top ASISA funds",
subtitle = "Benchmark: Capped SWIX",
y = "Rolling Return",
x = "Date"))
fmxdat::finplot(ggplot() +
geom_line(data = data_subset1 %>% dplyr::filter(Fund %in% best_asisa),
aes(x = date,
y = Rolling_Ret,
color = Fund),
size = 0.7,
alpha = 0.5) +
geom_line(data = data_subset1 %>% dplyr::filter(Fund %in% c("Benchmark")),
aes(x = date,
y = Rolling_Ret),
color = "black",
linetype = "dashed",
size = 0.8) +
geom_line(data = data_subset1 %>% dplyr::filter(Fund %in% c("AI_Fund")),
aes(x = date,
y = Rolling_Ret),
size = 0.8,
color = "red") +
labs(title = "Rolling returns of top ASISA funds",
subtitle = "Benchmark: Capped SWIX",
y = "Rolling Return",
x = "Date"))
fmxdat::finplot(ggplot() +
geom_line(data = data_subset1 %>% dplyr::filter(Fund %in% best_asisa),
aes(x = date,
y = Rolling_Ret,
color = Fund),
size = 0.7,
alpha = 0.5) +
geom_line(data = data_subset1 %>% dplyr::filter(Fund %in% c("Benchmark")),
aes(x = date,
y = Rolling_Ret),
color = "black",
size = 0.8) +
geom_line(data = data_subset1 %>% dplyr::filter(Fund %in% c("AI_Fund")),
aes(x = date,
y = Rolling_Ret),
size = 1,
color = "red") +
labs(title = "Rolling returns of top ASISA funds",
subtitle = "Benchmark: Capped SWIX",
y = "Rolling Return",
x = "Date"))
bm_cum_ret <- data %>%
dplyr::filter(date == max(date)) %>%
dplyr::filter(Fund == "Benchmark") %>%
pull(Cum_Ret)
exceed <- data %>%
dplyr::filter(date == max(date)) %>%
dplyr::filter(!(Fund %in% c("AI_Fund", "Benchmark"))) %>%
mutate(exceed = ifelse(Cum_Ret >= max(bm_cum_ret), 1, 0)) %>%
mutate(percent_exceed = sum(exceed) / length(unique(Fund)) * 100) %>%
pull(percent_exceed) %>%
unique
# Only 1.31 percent of all the funds in this data set perform above the benchmark according to accumulative returns
# If we take only the top 5 performing...
best_asisa <- data %>%
dplyr::filter(date == max(date)) %>%
dplyr::filter(!(Fund %in% c("AI_Fund", "Benchmark"))) %>%
mutate(exceed = ifelse(Cum_Ret >= bm_cum_ret, 1, 0)) %>%
dplyr::filter(exceed == 1) %>%
arrange(desc(Cum_Ret)) %>%
head(5) %>%
pull(Fund)
# Now filter the ASISA fund to only look at these 5 and our other two measures
data_subset1 <- data %>%
dplyr::filter(Fund %in% c(best_asisa, c("AI_Fund", "Benchmark")))
# Random funds
set.seed(98765)
data_subset2 <- data %>%
dplyr::filter(Fund %in% c(sample(unique(asisa$Fund), 5), c("AI_Fund", "Benchmark")))
fmxdat::finplot(ggplot() +
geom_line(data = data_subset1 %>% dplyr::filter(Fund %in% best_asisa),
aes(x = date,
y = Rolling_Ret,
color = Fund),
size = 0.7,
alpha = 0.5) +
geom_line(data = data_subset1 %>% dplyr::filter(Fund %in% c("Benchmark")),
aes(x = date,
y = Rolling_Ret),
color = "black",
size = 0.8) +
geom_line(data = data_subset1 %>% dplyr::filter(Fund %in% c("AI_Fund")),
aes(x = date,
y = Rolling_Ret),
size = 1,
color = "red") +
labs(title = "Rolling returns of top ASISA funds",
subtitle = "Benchmark: Capped SWIX",
y = "Rolling Return",
x = "Date"))
fmxdat::finplot(ggplot(strat1, aes(x = Fund, fill = Performance)) +
geom_bar() +
labs(title = "Performance Comparison of Funds vs Benchmark",
x = "Performance Category",
y = "Number of Observations") +
theme_bw())
fmxdat::finplot(ggplot(strat2, aes(x = Fund, fill = Performance)) +
geom_bar() +
labs(title = "Performance Comparison of Funds vs Benchmark",
x = "Performance Category",
y = "Number of Observations"))
fmxdat::finplot(ggplot(strat2, aes(x = Fund, fill = Performance)) +
geom_bar() +
labs(title = "Random ASISA Funds VS AI Implementer",
x = "Performance Category",
y = "Number of Observations"))
fmxdat::finplot(ggplot(strat1, aes(x = Fund, fill = Performance)) +
geom_bar() +
labs(title = "Top 5 ASISA funds VS AI Implementer",
x = "Performance Category",
y = "Number of Observations") +
theme_bw())
